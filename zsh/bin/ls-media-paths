#!/usr/bin/env zsh

usage() {
  echo "Usage: $0 [--include-backups]"
  echo ""
  echo "Options:"
  echo "  --include-backups  Include paths with 'Backup' in the name"
  exit 1
}

INCLUDE_BACKUPS=false

# Parse args
while [[ $# -gt 0 ]]; do
  case "$1" in
    --include-backups)
      INCLUDE_BACKUPS=true
      ;;
    *)
      usage
      ;;
  esac
  shift
done

expand_paths_filtered() {
  local group="$1"

  if $INCLUDE_BACKUPS; then
    expand-paths "$group"
  else
    if command -v rg >/dev/null 2>&1; then
      expand-paths "$group" | rg -v 'Backup'
    else
      expand-paths "$group" | grep -v 'Backup'
    fi
  fi
}

# Media paths only
expand_paths_filtered "$EXTERNAL_MEDIA_PATHS"
expand_paths_filtered "$LOCAL_MEDIA_PATHS"
